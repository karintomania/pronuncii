{% extends "main/base.html" %}

{% block content %}
<div
    x-data="{
        ...assessment(
            document.getElementById('audioClip'), 
            document.getElementById('id_recording')
        ),
        uiState: 'start',
        currentIndex:{{current_index}},
        sentenceCount:{{sentence_count}},
        isLastSentence: {{current_index}} === {{sentence_count}}-1,
    }"

    >
    <button
        id="record"
        class="button-accent"
        x-on:click="
            onStart();
            uiState = 'recording';
            "
        x-show="uiState==='start'"
        >
            start recording
    </button>
    <button
        id="stop"
        x-on:click="
            onStop()
            uiState = 'recorded';
        "
        x-show="uiState==='recording'"
        >
            stop recording
    </button>
    <button
        id="record-again"
        x-on:click="
            onStart();
            uiState = 'recording';
            "
        x-show="uiState==='recorded'"
        >
            record again
    </button>
    <li>{{ sentence.id }}</a></li>
    <li>{{ sentence.sentence }}</a></li>
    <li>{{ sentence.sound_path }}</a></li>
    <li x-text="uiState"></li>
    <form
        :action="isLastSentence ?
                '{% url  'main:finish_assessment' %}'
                :'{% url  'main:next' %}'"
        method="POST"
        enctype="multipart/form-data">
        {% csrf_token %}
        {{ form }}
        <input
            type="submit" 
            x-show="uiState==='recorded'">
    </form>
    <div class="sound-clips">
        <article>
            <audio
                id="audioClip"
                >

            </audio>
        </article>
    </div>
</div>
{% endblock content %}

{% block script %}
<script>

</script>
{% endblock %}
